<!DOCTYPE html><html class="default" lang="en" data-base=".."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>design/schema_service | agent-swarm-kit</title><meta name="description" content="Documentation for agent-swarm-kit"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">agent-swarm-kit</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">agent-swarm-kit</a></li><li><a href="design_schema_service.html">design/schema_service</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="schema-services" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Schema Services<a href="#schema-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p>Schema Services provide centralized component definition and configuration management for the agent-swarm-kit framework. They serve as the foundational layer that defines how agents, tools, completions, storages, states, and other system components are configured, validated, and registered within the swarm ecosystem.</p>
<p>For information about how these schemas are used during runtime, see <a href="#3.3">Connection Services</a>. For details on the public APIs that consume these schemas, see <a href="#3.4">Public Services</a>.</p>
<a id="architecture-overview" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Architecture Overview<a href="#architecture-overview" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The schema services form a critical layer in the dependency injection system, providing validated configuration storage for all swarm components. Each service follows a consistent pattern using <code>ToolRegistry</code> from functools-kit for efficient storage and retrieval.</p>
<p><img src="../media/15_Schema_Services_0.svg" alt="Mermaid Diagram"></p>
<a id="core-schema-service-pattern" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Core Schema Service Pattern<a href="#core-schema-service-pattern" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>All schema services implement a consistent pattern for component registration and retrieval. This pattern provides type safety, validation, and efficient storage using <code>ToolRegistry</code>.</p>
<a id="common-interface" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Common Interface<a href="#common-interface" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p><img src="../media/15_Schema_Services_1.svg" alt="Mermaid Diagram"></p>
<a id="registry-context-management" class="tsd-anchor"></a><h3 class="tsd-anchor-link">Registry Context Management<a href="#registry-context-management" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Schema services support context-aware registry management through <code>SchemaContextService</code>. This allows for schema overrides during specific execution contexts, such as pipeline operations.</p>
<table>
<thead>
<tr>
<th>Context State</th>
<th>Registry Source</th>
<th>Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td>No Context</td>
<td>Private <code>_registry</code></td>
<td>Normal operation</td>
</tr>
<tr>
<td>Schema Context Active</td>
<td><code>context.registry.{serviceName}</code></td>
<td>Pipeline/execution overrides</td>
</tr>
</tbody>
</table>
<a id="individual-schema-services" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Individual Schema Services<a href="#individual-schema-services" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><a id="agentschemaservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">AgentSchemaService<a href="#agentschemaservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Manages <code>IAgentSchemaInternal</code> configurations defining agent behavior, dependencies, and resources.</p>
<p><strong>Key Validation Rules:</strong></p>
<ul>
<li><code>agentName</code> must be string</li>
<li><code>completion</code> required for non-operator agents</li>
<li><code>prompt</code> required for non-operator agents</li>
<li>Array fields (<code>system</code>, <code>dependsOn</code>, <code>states</code>, <code>storages</code>, <code>tools</code>, <code>mcp</code>) must contain unique strings</li>
</ul>
<p><strong>Integration Points:</strong></p>
<ul>
<li>AgentConnectionService (agent instantiation)</li>
<li>SwarmConnectionService (swarm configuration)</li>
<li>ClientAgent (schema-driven execution)</li>
</ul>
<a id="toolschemaservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">ToolSchemaService<a href="#toolschemaservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Manages <code>IAgentTool</code> schemas defining tool execution logic and validation.</p>
<p><strong>Key Validation Rules:</strong></p>
<ul>
<li><code>toolName</code> must be string</li>
<li><code>call</code> must be function</li>
<li><code>validate</code> must be function (if present)</li>
<li><code>function</code> must be object or function</li>
</ul>
<p><strong>Default Integration:</strong></p>
<ul>
<li>Provides <code>CC_DEFAULT_AGENT_TOOL_VALIDATE</code> fallback for validation</li>
</ul>
<a id="completionschemaservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">CompletionSchemaService<a href="#completionschemaservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Manages <code>ICompletionSchema</code> configurations for AI model integrations.</p>
<p><strong>Key Validation Rules:</strong></p>
<ul>
<li><code>completionName</code> must be string</li>
<li><code>getCompletion</code> must be function</li>
<li><code>flags</code> must be array of strings (if present)</li>
</ul>
<a id="swarmschemaservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">SwarmSchemaService<a href="#swarmschemaservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Manages <code>ISwarmSchema</code> configurations for agent orchestration.</p>
<p><strong>Key Validation Rules:</strong></p>
<ul>
<li><code>swarmName</code> must be string</li>
<li><code>defaultAgent</code> must be string</li>
<li><code>agentList</code> must be array of unique strings</li>
<li><code>policies</code> must be array of unique strings (if present)</li>
</ul>
<a id="stateschemaservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">StateSchemaService<a href="#stateschemaservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Manages <code>IStateSchema</code> configurations for state management.</p>
<p><strong>Key Validation Rules:</strong></p>
<ul>
<li><code>stateName</code> must be string</li>
<li><code>getDefaultState</code> must be function</li>
<li><code>middlewares</code> must be array of functions (if present)</li>
</ul>
<a id="storageschemaservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">StorageSchemaService<a href="#storageschemaservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Manages <code>IStorageSchema</code> configurations for data persistence and retrieval.</p>
<p><strong>Key Validation Rules:</strong></p>
<ul>
<li><code>storageName</code> must be string</li>
<li><code>createIndex</code> must be function</li>
<li><code>embedding</code> must be string (EmbeddingName reference)</li>
</ul>
<a id="embeddingschemaservice" class="tsd-anchor"></a><h3 class="tsd-anchor-link">EmbeddingSchemaService<a href="#embeddingschemaservice" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Manages <code>IEmbeddingSchema</code> configurations for vector similarity operations.</p>
<p><strong>Key Validation Rules:</strong></p>
<ul>
<li><code>embeddingName</code> must be string</li>
<li><code>calculateSimilarity</code> must be function</li>
<li><code>createEmbedding</code> must be function</li>
</ul>
<a id="schema-context-system" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Schema Context System<a href="#schema-context-system" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The schema context system enables runtime schema overrides, particularly useful for pipeline operations where temporary schema modifications are needed.</p>
<p><img src="../media/15_Schema_Services_2.svg" alt="Mermaid Diagram"></p>
<a id="integration-with-dependency-injection" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Integration with Dependency Injection<a href="#integration-with-dependency-injection" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Schema services are registered in the DI container and consumed by connection services, validation services, and public APIs.</p>
<p><img src="../media/15_Schema_Services_3.svg" alt="Mermaid Diagram"></p>
<a id="logging-and-performance" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Logging and Performance<a href="#logging-and-performance" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>All schema services integrate with <code>LoggerService</code> for operations logging, controlled by <code>GLOBAL_CONFIG.CC_LOGGER_ENABLE_INFO</code>. This provides consistent debugging capabilities across the schema layer.</p>
<p><strong>Logged Operations:</strong></p>
<ul>
<li>Schema validation (<code>validateShallow</code>)</li>
<li>Registration (<code>register</code>)</li>
<li>Override (<code>override</code>)</li>
<li>Retrieval (<code>get</code>)</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#schema-services"><span>Schema <wbr/>Services</span></a><ul><li><a href="#architecture-overview"><span>Architecture <wbr/>Overview</span></a></li><li><a href="#core-schema-service-pattern"><span>Core <wbr/>Schema <wbr/>Service <wbr/>Pattern</span></a></li><li><ul><li><a href="#common-interface"><span>Common <wbr/>Interface</span></a></li><li><a href="#registry-context-management"><span>Registry <wbr/>Context <wbr/>Management</span></a></li></ul></li><li><a href="#individual-schema-services"><span>Individual <wbr/>Schema <wbr/>Services</span></a></li><li><ul><li><a href="#agentschemaservice"><span>Agent<wbr/>Schema<wbr/>Service</span></a></li><li><a href="#toolschemaservice"><span>Tool<wbr/>Schema<wbr/>Service</span></a></li><li><a href="#completionschemaservice"><span>Completion<wbr/>Schema<wbr/>Service</span></a></li><li><a href="#swarmschemaservice"><span>Swarm<wbr/>Schema<wbr/>Service</span></a></li><li><a href="#stateschemaservice"><span>State<wbr/>Schema<wbr/>Service</span></a></li><li><a href="#storageschemaservice"><span>Storage<wbr/>Schema<wbr/>Service</span></a></li><li><a href="#embeddingschemaservice"><span>Embedding<wbr/>Schema<wbr/>Service</span></a></li></ul></li><li><a href="#schema-context-system"><span>Schema <wbr/>Context <wbr/>System</span></a></li><li><a href="#integration-with-dependency-injection"><span>Integration with <wbr/>Dependency <wbr/>Injection</span></a></li><li><a href="#logging-and-performance"><span>Logging and <wbr/>Performance</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">agent-swarm-kit</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(100273846, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        webvisor:true,
        ecommerce:"dataLayer"
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/100273846" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-85RYYZDT35"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-85RYYZDT35');
</script>
